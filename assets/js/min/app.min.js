$('#fullpage').fullpage({
	anchors: ['home', 'brands', 'work', 'capabilities', 'team', 'contact'],
	navigationTooltips: ['Home', 'Brands', 'Work', 'Capabilities', 'Team','Contact'],
	autoScrolling: false,
	scrollingSpeed: 1200,
	fitToSection: false,
	scrollOverflow: false,
	scrollBar: false,
	css3: true,
	navigation: true,
	navigationPosition: 'right',
	responsive: 900,
	keyboardScrolling: true,
	slidesNavigation: true
	
});


$('section').waypoint(function(){
	
    $(this).addClass('viz');
    //$(this).prev().removeClass('viz');
    //$(this).next().removeClass('viz');
  }, {
    offset: '50%'
  });
  
  
  $(window).scroll(function() {
  var scroll = $(window).scrollTop();
  $(".js-parallax-up").css("transform","translateY(" +  (scroll/2)  + "px)");
});

 $(window).scroll(function() {
  var scroll = $(window).scrollTop();
  $(".js-parallax-down").css("transform","translateY(" +  "-" + (scroll/2)  + "px)");
});



    
	var c = $('#canvasdrag canvas');
    var container = $(c).parent();

    $(window).resize( respondCanvas );

    function respondCanvas(){ 
        c.attr('width', $(container).width() ); 
        c.attr('height', $(container).height() ); 

    }

    respondCanvas();



/*
$(window).scrollTop();

$(window).scroll(function () {

	$('#fp-nav a').each(function(){
	    if($(this).hasClass('active')) {
	        $(this).parent().addClass('active');
	    } 
	});

});

*/

//mapbox
    L.mapbox.accessToken = 'pk.eyJ1IjoibGlseWMiLCJhIjoiQXBHUlVTbyJ9.QxO4FqhQBctzKoXdUfHU1w';
	
	
	var geojson = [
		  {
		  "type": "FeatureCollection",
		  "features": [
			{
			  "type": "Feature",
			  "properties": {},
			  "geometry": {
				"type": "Point",
				"coordinates": [
				  -79.34154510498047,
				  43.66293556940227
				]
			  },
			  "properties": {
				"title": "Dotfusion Digital Agency",
				"marker-color": "#fe800a",
				"marker-size": "medium",
				"marker-symbol": ""
			  }
			}
		  ]
		}
	];
	
	
	
	var map = L.mapbox.map('map-bg', 'lilyc.p4jkbo82', {
		
			scrollWheelZoom: false
		}).setView([43.6648253, -79.3421484], 15);
		


	var myLayer = L.mapbox.featureLayer().addTo(map);
	
	myLayer.setGeoJSON(geojson);


/*L.mapbox.accessToken = 'pk.eyJ1Ijoic2VhbmVoYWxwaW4iLCJhIjoiVk83MTd3MCJ9.kQndU4184f3XuT5-atShtw';
var map = L.mapbox.map('map', 'seanehalpin.lcg29l57', {
  zoomControl: false
}).setView([43.668, -79.342], 14);*/

	
// Disable drag and zoom handlers.
/*map.dragging.disable();
map.touchZoom.disable();
map.doubleClickZoom.disable();
map.scrollWheelZoom.disable();

// Disable tap handler, if present.
if (map.tap) map.tap.disable();*/



$(function(){
  function id(v){ return document.getElementById(v); }
  function loadbar() {
    var ovrl = id("overlay"),
        prog = id("progress"),
        //stat = id("progstat"),
        img = document.images,
        c = 0;
        tot = img.length;

    function imgLoaded(){
      c += 1;
      var perc = ((100/tot*c) << 0) +"%";
      prog.style.width = perc;
      //stat.innerHTML = "Loading "+ perc;
      if(c===tot) return doneLoading();
    }
    function doneLoading(){
      ovrl.style.opacity = 0;
      setTimeout(function(){ 
        ovrl.style.display = "none";
      }, 1200);
    }
    for(var i=0; i<tot; i++) {
      var tImg     = new Image();
      tImg.onload  = imgLoaded;
      tImg.onerror = imgLoaded;
      tImg.src     = img[i].src;
    }    
  }
  document.addEventListener('DOMContentLoaded', loadbar, false);
}());


/*! Lazy Load XT v1.0.6 2014-11-19
 * http://ressio.github.io/lazy-load-xt
 * (C) 2014 RESS.io
 * Licensed under MIT */

(function ($) {
    var options = $.lazyLoadXT;

    options.forceEvent += ' lazyautoload';
    options.autoLoadTime = options.autoLoadTime || 50;

    $(document).ready(function () {
        setTimeout(function () {
            $(window).trigger('lazyautoload');
        }, options.autoLoadTime);
    });

})(window.jQuery || window.Zepto || window.$);




